---
marp: true
theme: am_blue
paginate: true
math: katex
headingDivider: [2,3,4,5]
backgroundColor: #D0E8D6DA
---
[自动claude导入 - Claude](https://claude.ai/chat/0ff34348-581a-459b-a293-3b931a9efdc1)
1. 智能端口管理(查找空闲端口)
2. 进程管理(清理旧进程)
3. 无窗口启动服务
4. 自动打开浏览器预览
5. 跨平台支持(Windows/Unix)
6. 静默运行
7. 自动端口配置
8. 从剪贴板读取组件代码
9. 智能提取组件名称
10. 组件文件创建和归档
11. 自动更新路由配置
12. 剪贴板集成
13. 组件生命周期管理
14. 独立的组件卸载 API (/api/uninstall)
15. 动态组件展示页面 (page.tsx)
16. 组件存储目录 (/components)
17. 已卸载组件归档目录 (/components/Archive)
18. 独立的布局组件 (Layout.tsx)
19. 独立的侧边栏组件 (Sidebar.tsx)
20. 组件与布局解耦
21. 自适应的顶栏和侧栏
22. 新组件自动应用容器样式
23. 引入错误处理和日志记录机制
24. 提取常量到配置文件中,提高可维护性

1. 定义项目结构和配置:
   - 在项目根目录下创建一个 Python 脚本,如 setup_claude.py,作为项目的主入口。
   - 在脚本中定义项目的关键路径,如组件目录、存档目录、page.tsx 文件路径等。
   - 将一些常量提取到配置文件中,如端口范围、允许的组件名称正则表达式等。

2. 实现端口管理和进程清理:
   - 编写函数来查找可用的端口。可以参考你现有的 find_free_port 函数。
   - 编写函数来清理指定端口上的进程。可以使用 psutil 库来实现跨平台的进程管理。
   - 在启动开发服务器之前,先进行端口清理,确保端口可用。

3. 设计组件管理功能:
   - 编写函数来扫描组件目录,获取现有组件列表。
   - 监控系统剪贴板,当检测到新的组件代码时,从中提取组件名称。可以使用 pyperclip 库来访问剪贴板。
   - 将新组件保存到组件目录,并将组件信息添加到组件列表中。
   - 提供组件卸载功能,将卸载的组件移动到存档目录。

4. 生成动态的 page.tsx 和路由文件:
   - 编写 page.tsx 和路由文件的模板,使用 Python 的字符串格式化或模板引擎(如 Jinja2)来动态生成内容。
   - 根据组件列表动态更新 page.tsx 文件,自动添加新组件的导入语句和渲染逻辑。
   - 自动生成 /api/uninstall 路由文件,用于处理组件卸载请求。

5. 实现静默启动和浏览器打开:
   - 使用 subprocess 模块来执行 npm 命令,启动开发服务器。
   - 根据当前操作系统,设置适当的参数以实现静默启动(如在 Windows 上使用 CREATE_NO_WINDOW 标志)。
   - 在服务器启动后,使用 webbrowser 模块自动打开默认浏览器,预览页面。

6. 错误处理和日志记录:
   - 在关键步骤添加错误处理逻辑,捕获和处理可能的异常。
   - 使用 Python 的日志模块(如 logging)来记录关键事件和错误信息,方便调试和问题定位。

7. 优化和重构:
   - 将复杂的逻辑拆分为更小的函数,提高代码的可读性和可维护性。
   - 使用面向对象的方式组织代码,将相关的功能封装到类中。
   - 添加必要的注释和文档,说明关键功能和用法。

这样规划后,你的 Python 脚本就可以替代 setup-claude.mjs,完成组件管理、动态生成页面和路由、启动服务器等任务。你可以专注于使用 Python 的文本处理和文件操作能力,而不需要过多关注 TypeScript 的特性。
